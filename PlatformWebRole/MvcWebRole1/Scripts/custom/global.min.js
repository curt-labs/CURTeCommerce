var master_mount,master_year,master_make,master_model,master_style=0,year,make,model,style=0,animate_logo=true,urlAddress="http://www.discounthitches.com/",pageName="Discount Curt Trailer Hitches",modelClosingAction=null,cartRendering,cartHovered=false,cartItems=[],validateForm,closeError,resetLookup,displayError,displayMessage,addFavorite,showThanks,changeTab,populateCart,showCart,updateCart,hideCart,cartTimer,startCartTimer,prepareCart,toTitleCase,showLoader,CartItem,getTimestamp;$(function(){$("body").append('<div id="cartbox"></div>');$("#cartbox").css({left:$("#cartlink").offset().left+"px",top:$("#cartlink").position().top+$("#cartlink").outerHeight()+"px"});CartItem=function(c,e,d,a,b){this.partID=c;this.shortDesc=a;this.qty=e;this.price=d;this.loaded=b};validateForm=function(b){var a=0;$.each($(b).find("input[required],textarea[required],select[required]"),function(){var b=$(this).attr("id");if($(this).val()==0||$(this).val().length==0){$(this).addClass("err");$(this).closest("label").find("span.required-helper").length===0&&$(this).before('<span class="required-helper">'+$(this).attr("title")+"</span>");a++}else{$(this).removeClass("err");this.nodeName.toLowerCase()==="select"&&$(this).parent(".shadow").removeClass("err-shadow");$(this).closest("label").find("span.required-helper").remove()}});if(a>0){$.modal.close();return false}return true};closeError=function(){$(".error_display").hide()};resetLookup=function(){$("#master_lookup label[for=year]").hide();$("#master_lookup label[for=make]").hide();$("#master_lookup label[for=model]").hide();$("#master_lookup label[for=style]").hide();$("#master_lookup label[for=mount]").show();$("#master_lookup #mount").val(0).removeAttr("disabled");$("#master_lookup #year").html('<option value="0">- Select Year -</option>').attr("disabled","disabled");$("#master_lookup #make").html('<option value="0">- Select Make -</option>').attr("disabled","disabled");$("#master_lookup #model").html('<option value="0">- Select Model -</option>').attr("disabled","disabled");$("#master_lookup #style").html('<option value="0">- Select Style -</option>').attr("disabled","disabled");$("#master_lookup label span").hide();$("#master_lookup label select").removeClass("err")};displayError=function(a){$(".error_display").find(".err").html(a);$(".error_display").fadeIn();setTimeout(closeError(),5e3)};displayMessage=function(a){displayError(a)};addFavorite=function(){if(window.sidebar)window.sidebar.addPanel(pageName,urlAddress,"");else if(window.external&&$.browser.webkit!=true)window.external.AddFavorite(urlAddress,pageName);else if(window.opera&&window.print){var a=document.createElement("a");$(a).attr("href",urlAddress);$(a).setAttribute("title",pageName);$(a).setAttribute("rel","sidebar");$(a).click();return false}else displayMessage("Don't forget to bookmark us! (Ctrl+D)")};showThanks=function(){$.modal('<span class="modalThanks">Thank you for sharing!</span>',{containerCss:{backgroundColor:"#ffffff",borderColor:"#ffffff",height:"100px",width:"400px",padding:"10px"}});setTimeout("$.modal.close()",5e3)};changeTab=function(a){if(a.length>0){var b;b=$("#"+a).get()[0];if(b!=undefined&&b!=null){var c,d;c=$("a[href=#"+a+"]").parent().parent().find("a.active");d=c.length>0?$(c).attr("href"):"";$(c).removeClass("active");$("a[href=#"+a+"]").addClass("active");$(b).parent().find("div.tab_content"+(d!=""?d:"")).fadeOut(400,function(){$(this).removeClass("active");$(b).fadeIn(400,function(){$(b).addClass("active")})})}else{$("div.tab_container div.tab_content:first").show();$("ul.tabs li:first a").addClass("active");if($("div.part_container").get()!==undefined&&$("div.part_container").get().length>0){$("div.part_tab_container li:first a").addClass("active");$("div.part_container div.part_content:first").show()}}}else{a=$("ul.tabs li a:first").attr("href");if(a!==undefined&&a.indexOf("#")>-1)changeTab(a.replace("#",""));else $("div.tab_container div.tab_content:first").show()}};prepareCart=function(){if(!cartRendering){$("#cartbox").empty();$("#cartbox").append('<img id="cartloader" src="/Content/img/ajax-loader.gif" alt="loading..." />')}};populateCart=function(){$.getJSON("/Cart/getCart",{ts:getTimestamp()},function(a){cartItems=[];$(a.CartItems).each(function(c,a){var b=a.quantity*Number(a.price);cartItems.push(new CartItem(a.partID,a.quantity,b,a.shortDesc,true))});updateCart()})};showCart=function(){$("#cartbox").css({left:$("#cartlink").offset().left+"px",top:$("#cartlink").position().top+$("#cartlink").outerHeight()+"px"});clearTimeout(cartTimer);$("#cartbox").stop(true).fadeTo("fast",1)};updateCart=function(){$("#cartbox").empty();if(cartItems.length>0){var a="<table><thead><tr><th>Part</th><th>Qty</th><th>Price</th></tr></thead><tbody>",c=0,b=0;$(cartItems).each(function(e,d){c+=d.price;b+=d.qty;a+='<tr><td class="'+(d.loaded?"loaded":"notloaded")+'"><a href="/Part/'+d.partID+'">'+d.shortDesc+'</a></td><td class="qty">'+d.qty+'</td><td class="price">$'+d.price.toFixed(2)+"</td>";if(d.loaded)a+='<td><a href="/Cart/Remove/'+d.partID+'" data-id="'+d.partID+'" class="remove">&times;</a></td></tr>';else a+='<td><img src="/Content/img/ajax-loader-small.gif" alt="adding to cart..." /></td></tr>'});a+='</tbody><tfoot><td colspan="2">Subtotal:</td><td class="price">$'+c.toFixed(2)+"</td><td></td></tfoot></table>";a+='<a href="/Cart/Checkout" class="button">Checkout</a>';$("#cartCount").html(b);$("#cartbox").append(a)}else{$("#cartCount").html(0);$("#cartbox").append("<p>There are no items in your cart. You should add something.</p>")}};startCartTimer=function(a){if(a==undefined)a=3e3;clearTimeout(cartTimer);cartTimer=setTimeout(hideCart,a)};hideCart=function(){!cartHovered&&$("#cartbox").fadeOut(1500)};toTitleCase=function(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})};showLoader=function(b){var a='<div style="width:100%;text-align:center;margin-top:100px;">';a+='<img src="/Content/img/large-loader.gif" alt="Loading..." style="width:140px" />';a+='<span style="font-size: 24px;display:block;margin-top:25px">'+b+"</span>";a+="</div>";$.modal(a,{containerId:"simplemodal-loader",containerCss:{backgroundColor:"#ffffff",height:"400px",width:"800px",padding:"10px"},onClose:function(a){a.data.fadeOut("400",function(){a.container.hide("400",function(){a.overlay.slideUp("fase",function(){$.modal.close()})})})}})};if($.browser.msie){($.browser.version<9||document.documentMode<9)&&$("#master_lookup #style").focus(function(){$(this).data("origWidth",$(this).width()).css("width","auto")}).blur(function(){$(this).css("width",$(this).data("origWidth"))});if($.browser.version<8||document.documentMode<8){$("header").css("height","130px").css("margin-bottom","0px").css("margin-top","60px");$("header").find(".sub_bar").css("z-index","15000").find(".logo").show();$("#top_bar").css("position","absolute");$("#scroll_logo").css("visibility","hidden");$("#cartbox").css("position","absolute");animate_logo=false;var a;$("select").each(function(){a=$(this);a.data("origWidth",a.outerWidth())}).mouseenter(function(){$(this).css("width","auto");$(this).parent("label").css("overflow","hidden")}).bind("blur change",function(){a=$(this);a.css("width",a.data("origWidth"))})}}if(animate_logo){$("header").css("height","130px").css("margin-bottom","0px").css("margin-top","60px");$("header").find(".logo").show();if($(window).width()<1020)$("#top_bar").css("position","absolute");else $("#top_bar").css("position","fixed");$("#scroll_logo").css("visibility","hidden");$(window).scroll(function(){var a=$(this).scrollTop();if(a>52){$("#scroll_logo").css("visibility","visible");$("header").find(".logo").hide()}else{$("#scroll_logo").css("visibility","hidden");$("header").find(".logo").show()}});$(window).resize(function(){if($(window).width()<1020)$("#top_bar").css("position","absolute");else $("#top_bar").css("position","fixed")})}$("#master_lookup #reset_lookup").click(function(){resetLookup()});$("#master_lookup select").attr("disabled","disabled");$("#master_lookup select:first").removeAttr("disabled");$("#master_lookup #mount").change(function(){$("#master_lookup label img").css("display","none");master_year=master_make=master_model=null;$("#master_lookup #year, #master_lookup #make","#master_lookup #model","#master_lookup #style").attr("disabled","disabled");$("#master_lookup #year").html('<option value="0">- Select Year -</option>');$("#master_lookup #make").html('<option value="0">- Select Make -</option>');$("#master_lookup #model").html('<option value="0">- Select Model -</option>');$("#master_lookup #style").html('<option value="0">- Select Style -</option>');master_mount=$(this).val();master_mount!==0&&master_mount!==null&&$("#master_lookup #mount").removeClass("err");$.getJSON("http://api.curtmfg.com/v2/getyear?callback=?",{mount:master_mount,dataType:"JSONP"},function(a){$.each(a,function(c,b){var a=document.createElement("option");$(a).text(b);$("#master_lookup #year").append(a)});$("#master_lookup label[for=mount]").hide();$("#master_lookup label[for=year]").show();$("#master_lookup #year").removeAttr("disabled").focus();$("#master_lookup label img").css("display","none")})});$("#master_lookup #year").change(function(){$("#master_lookup label img").css("display","none");master_make=master_model=null;$("#master_lookup #make","#master_lookup #model","#master_lookup #style").attr("disabled","disabled");$("#master_lookup #make").html('<option value="0">- Select Make -</option>');$("#master_lookup #model").html('<option value="0">- Select Model -</option>');$("#master_lookup #style").html('<option value="0">- Select Style -</option>');master_year=$(this).val();master_year!==0&&master_year!==null&&$("#master_lookup #year").removeClass("err").next().next().hide();$.getJSON("http://api.curtmfg.com/v2/getmake?callback=?",{mount:master_mount,year:master_year,dataType:"JSONP"},function(a){$.each(a,function(c,b){var a=document.createElement("option");$(a).text(b);$("#master_lookup #make").append(a)});$("#master_lookup label[for=year]").hide();$("#master_lookup label[for=make]").show();$("#master_lookup #make").removeAttr("disabled").focus();$("#master_lookup label img").css("display","none")})});$("#master_lookup #make").change(function(){$("#master_lookup label img").css("display","none");master_model=null;$("#master_lookup #model","#master_lookup #style").attr("disabled","disabled");$("#master_lookup #model").html('<option value="0">- Select Model -</option>');$("#master_lookup #style").html('<option value="0">- Select Style -</option>');master_make=$(this).val();master_make!==0&&master_make!==null&&$("#master_lookup #make").removeClass("err").next().next().hide();$.getJSON("http://api.curtmfg.com/v2/getmodel?callback=?",{mount:master_mount,year:master_year,make:master_make,dataType:"JSONP"},function(a){$.each(a,function(c,b){var a=document.createElement("option");$(a).text(b);$("#master_lookup #model").append(a)});$("#master_lookup label[for=make]").hide();$("#master_lookup label[for=model]").show();$("#master_lookup #model").removeAttr("disabled").focus();$("#master_lookup label img").css("display","none")})});$("#master_lookup #model").change(function(){$("#master_lookup label img").css("display","none");$("#master_lookup #style").attr("disabled","disabled");$("#master_lookup #style").html('<option value="0">- Select Style -</option>');master_model=$(this).val();master_model!==0&&master_model!==null&&$("#master_lookup #model").removeClass("err").next().next().hide();$.getJSON("http://api.curtmfg.com/v2/getstyle?callback=?",{mount:master_mount,year:master_year,make:master_make,model:master_model,dataType:"JSONP"},function(a){$.each(a,function(c,b){var a=document.createElement("option");$(a).text(b);$("#master_lookup #style").append(a)});$("#master_lookup label[for=model]").hide();$("#master_lookup label[for=style]").show();$("#master_lookup #style").removeAttr("disabled").focus();$("#master_lookup label img").css("display","none")})});$("#master_lookup #style").change(function(){$("#master_lookup input[type=submit]").removeAttr("disabled").focus();master_style=$(this).val();master_style!==0&&master_style!==null&&$("#master_lookup #style").removeClass("err").next().next().hide()});$("#master_lookup input[type=submit]").click(function(b){b.preventDefault();master_style=$("#master_lookup #style").val();var a=true;if(master_year===0||master_year===null){a=false;$("#master_lookup #year").addClass("err").next().next().css("display","block")}else $("#master_lookup #year").removeClass("err").next().next().hide();if(master_make===0||master_make===null){a=false;$("#master_lookup #make").addClass("err").next().next().css("display","block")}else $("#master_lookup #make").removeClass("err").next().next().hide();if(master_model===0||master_model===null){a=false;$("#master_lookup #model").addClass("err").next().next().css("display","block")}else $("#master_lookup #model").removeClass("err").next().hide();if(master_style===0||master_style===null){a=false;$("#master_lookup #style").addClass("err").next().next().css("display","block")}else $("#master_lookup #style").removeClass("err").next().hide();if(a)window.location.href=window.location.protocol+"//"+window.location.host+"/Lookup/"+encodeURIComponent(master_year)+"/"+encodeURIComponent(master_make)+"/"+encodeURIComponent(master_model)+"/"+encodeURIComponent(master_style.replace(/\//g,"!"));else displayError("There was an error while processing your request")});$("#master_lookup #year").val()>0&&$("#master_lookup #year").change();$(".error_display .close").live("click",function(){closeError()});var b,c;b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="https://apis.google.com/js/plusone.js";c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c);if(window.sidebar||window.external&&$.browser.webkit!=true||window.opera&&window.print){var d='<a href="javascript:void(0)" title="Bookmark Us" class="bookmark">Bookmark Us</a>';$("div.sub_menu_container span.phone").before(d);$(".bookmark").live("click",function(){addFavorite()})}$.extend($.modal.defaults,{closeClass:"modalClose",closeHTML:"<a href='javascript:void(0)'>Close<span>x</span></a>",opacity:80,onOpen:function(a){a.overlay.fadeIn("400",function(){a.data.hide();a.container.fadeIn("400",function(){a.data.slideDown("fast");modelClosingAction=null})})},onClose:function(a){a.data.fadeOut("400",function(){a.container.hide("400",function(){a.overlay.slideUp("fast",function(){$.modal.close()})})})},overlayClose:true});$("a.email-share").click(function(b){b.preventDefault();var a=$(this);$.get($(a).attr("href")+"&layout=false",function(b){if($(a).attr("href").indexOf("part")!==-1)$.modal(b,{containerCss:{backgroundColor:"#ffffff",borderColor:"#ffffff",height:"700px",width:"800px",padding:"10px"},onClose:function(a){a.data.fadeOut("400",function(){a.container.hide("400",function(){a.overlay.slideUp("fase",function(){$.modal.close()})})})}});else $.modal(b,{containerCss:{backgroundColor:"#ffffff",borderColor:"#ffffff",height:"700px",width:"500px",padding:"10px"},onClose:function(a){if(modelClosingAction==="showThanks"){$("#simplemodal-overlay").remove();$("#simplemodal-container").remove();showThanks()}else a.data.fadeOut("400",function(){a.container.hide("400",function(){a.overlay.slideUp("fase",function(){$.modal.close()})})})}});$("form.share-form input[type=submit]").css("display","inline-block").after('<a href="javascript:$.modal.close()" title="Close" style="margin-left:10px;vertical-align:bottom;">Close</a>');$("form.share-form input[type=submit]").live("click",function(c){$("#simplemodal-container").find("span.error").remove();c.preventDefault();var b,a;a={};b=$("form.share-form").attr("action");a.recipient=$("#recipient").val();a.sender=$("#sender").val();a.subj=$("#subj").val();a.msg=$("#msg").val();a.ajax=true;$.post(b,a,function(a){if(a.length>0)$("span.share-heading").after('<span class="share-heading error" style="color:red;font-size:13px;font-weight:bold">'+a+"</span>");else{modelClosingAction="showThanks";$.modal.close()}})})});return false});$(document).on("click","form.simple-form input[type=submit]",function(){return validateForm($(this).closest(".simple-form"))});$(document).on("change keyup","form.simple-form input,form.simple-form textarea,form.simple-form select",function(){validateForm($(this).closest(".simple-form"))});$("ul.tabs li a:first").addClass("active");$("div.tab_container div.tab_content").hide();$("div.tab_container div.tab_content:first").addClass("active");$(document).on("click","a.add_cart",function(e){e.preventDefault();var a=$(this).data("id"),d=$("#"+a).find("h4").html(),c=Number($("#"+a).find("span.price").html().replace("$","")),b=false;$(cartItems).each(function(e,d){if(d.partID==a){d.qty+=1;d.price=d.qty*c;b=true}});!b&&cartItems.push(new CartItem(a,1,c,d,false));updateCart();showCart();startCartTimer();$.getJSON("/Cart/AddAjax",{id:a,qty:1,ts:getTimestamp()},function(){populateCart()})});$(document).on("click","#cartbox table a.remove",function(c){c.preventDefault();var a=$(this).data("id"),b=$(this).parent().parent().get(0);$(cartItems).each(function(c,b){b.partID==a&&cartItems.splice(c,1)});if(cartItems.length>0)$(b).fadeOut("fast",function(){$.getJSON("/Cart/RemoveAjax",{id:a,ts:getTimestamp()},populateCart)});else{$("#cartbox").empty();$("#cartbox").append('<p style="display: none;">There are no items in your cart. You should add something.</p>');$("#cartbox p").fadeIn("fast",function(){$.getJSON("/Cart/RemoveAjax",{id:a,ts:getTimestamp()},populateCart)})}});$("#partAddToCart").submit(function(f){f.preventDefault();var b=$(this).data("id"),e=$("#mid_col").find("span.shortDesc").html(),d=Number($("#qty").val()),a=$("#mid_col").find("span.price").html().replace("$","");a=Number(a);var c=false;$(cartItems).each(function(f,e){if(e.partID==b){e.qty+=d;e.price=e.qty*a;c=true}});!c&&cartItems.push(new CartItem(b,d,a,e,false));updateCart();showCart();startCartTimer();$.getJSON("/Cart/AddAjax",{id:b,qty:$("#qty").val(),ts:getTimestamp()},function(){populateCart()})});getTimestamp=function(){var a=new Date;return a.getDay().toString()+a.getMonth().toString()+a.getYear().toString()+a.getHours().toString()+a.getMinutes().toString()+a.getSeconds().toString()+a.getMilliseconds().toString()+a.getTimezoneOffset().toString()};$("#cartlink, #cartbox").hover(function(){cartHovered=true;showCart()},function(){cartHovered=false;startCartTimer(300)});populateCart();$(window).bind("hashchange",function(){var a=$.param,b=a.fragment();changeTab(b)});$(window).trigger("hashchange");var e=new Image;e.src="/Content/img/large-loader.gif"});