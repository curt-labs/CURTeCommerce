var ids = [], view_more_trigger = 0, page = 1, perpage = 20, endless_load = true, generateHTML, getMore, loadInstallSheet, parts; $(function () { view_more_trigger = $("#part_container").height() - 1e3; $(window).scroll(function () { var a = $(window).scrollTop(); if (a > view_more_trigger && endless_load) { page = page + 1; getMore(page, perpage) } }); $(".view_more").live("click", function (a) { a.preventDefault(); page = page + 1; getMore(page, perpage) }); getMore = function (c, d) { var b, a; b = $("#searchTerm").val(); a = { page: c, perpage: d, search: b }; $.get("/Search/GetMore", a, function (a) { if (a.length > 0) $.each(a, function (c, a) { if (ids.indexOf(a.partID) === -1) { ids.push(a.partID); var b = generateHTML(a); $(".part_groups").height($(".part_groups").height() + 330); $(".part:last").after(b); view_more_trigger = $("#part_container").height() - 1e3 } }); else { endless_load = false; $(".view_more").remove() } }, "json") }; generateHTML = function (b) { var c, a; c = $(".part").get().length; a = ""; a += '<div class="part" id="' + b.partID + '">'; a += "<h4>" + b.shortDesc + "</h4>"; a += '<div class="left_col">'; a += "<p>Part #" + b.partID + "</p>"; a += '<div class="image_array">'; a += '<a class="main" href="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_1024x768_a.jpg" rel="Shadowbox[parts' + c + ']" target="_blank" title="Click to enlarge">'; a += '<img src="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_300x225_a.jpg" onerror="$(this).parent().remove()" alt="Click to enlarge" />'; a += "</a>"; a += '<a class="sub" href="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_1024x768_b.jpg" rel="Shadowbox[parts' + c + ']" title="Click to enlarge">'; a += '<img src="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_100x75_b.jpg" onerror="$(this).parent().remove()" alt="Click to enlarge" />'; a += "</a>"; a += '<a class="sub" href="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_1024x768_c.jpg"  rel="Shadowbox[parts' + c + ']" title="Click to enlarge">'; a += '<img src="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_100x75_c.jpg" onerror="$(this).parent().remove()" alt="Click to enlarge" />'; a += "</a>"; a += '<a class="sub" href="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_1024x768_d.jpg"  rel="Shadowbox[parts' + c + ']" title="Click to enlarge">'; a += '<img src="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_100x75_d.jpg" onerror="$(this).parent().remove()" alt="Click to enlarge" />'; a += "</a>"; a += '<a class="sub" href="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_1024x768_e.jpg"  rel="Shadowbox[parts' + c + ']" title="Click to enlarge">'; a += '<img src="https://www.curtmfg.com/CURTLibrary/' + b.partID + "/images/" + b.partID + '_100x75_e.jpg" onerror="$(this).parent().remove()" alt="Click to enlarge" />'; a += "</a>"; a += "</div>"; a += "</div>"; a += '<div class="mid_col">'; a += "<ul>"; $.each(b.content, function (c, b) { if (b.key.toUpperCase() !== "INSTALLATIONSHEET" && b.key.toUpperCase() !== "INSTALLVIDEO") a += "<li>" + b.value + "</li>" }); a += "</ul>"; a += "</div>"; a += '<div class="right_col">'; a += '<span class="price">' + b.listPrice + "</span>"; a += '<a href="/Part/' + b.partID + '" class="details" title="View Details">View Details</a>'; a += '<a href="/Cart/Add/' + b.partID + '" class="add_cart" data-id="' + b.partID + '" title="Add to Cart">'; a += '<img src="/Content/img/cart.png" alt="Add to Cart" />'; a += "<span>Add to Cart</span>"; a += "</a>"; a += loadInstallSheet(b); a += "</div>"; a += '<div class="clearfix"></div>'; a += "</div></div>"; return a }; loadInstallSheet = function (b) { var a; a = ""; $.each(b.content, function (c, b) { if (b.key.toUpperCase() === "INSTALLATIONSHEET" && a.length === 0) { a += '<a href="' + b.value + '" title="Download Installation Instructions" class="install">'; a += '<img src="/Content/img/pdf.png" alt="Download Installation Instructions" />Installation Instructions</a>' } }); return a }; parts = $(".part").get(); $.each(parts, function () { var a = parseInt($(this).attr("id")); ids.push(a) }) });